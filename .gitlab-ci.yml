image: openjdk:11.0.4

stages:
  - build
  - deploy

build-backend:
  before_script:
    - apt-get update -qq && apt-get install -y -qq maven
  stage: build
  script: mvn clean compile

build-frontend:
  before_script:
    - cd src/main/react
    - curl https://nodejs.org/dist/v12.10.0/node-v12.10.0-linux-x64.tar.gz --output node.tar.gz
    - tar -xf node.tar.gz
    - ./node-v12.10.0-linux-x64/bin/npm ci
  stage: build
  script: ./node-v12.10.0-linux-x64/bin/npm run build

deploy:
  stage: deploy
  script: mvn package
  artifacts:
    paths:
      - target/taskorger-1.0-SNAPSHOT.jar