image: openjdk:11.0.11+9

stages:
  - build
  - deploy

build-backend:
  before_script:
    - apt-get update -qq && apt-get install -y -qq maven
  stage: build
  script: mvn clean compile

build-frontend:
  before_script:
    - curl -sL https://deb.nodesource.com/setup_10.x | bash -
    - apt-get install -y -qq nodejs
    - cd src/main/react && npm ci
  stage: build
  script: npm run build

deploy:
  before_script:
    - apt-get update -qq && apt-get install -y -qq maven
  stage: deploy
  script: mvn package
  artifacts:
    paths:
      - target/taskorger-1.0-SNAPSHOT.jar